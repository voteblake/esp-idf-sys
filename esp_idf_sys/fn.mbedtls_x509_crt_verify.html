<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="\brief          Verify the certificate signature"><meta name="keywords" content="rust, rustlang, rust-lang, mbedtls_x509_crt_verify"><title>mbedtls_x509_crt_verify in esp_idf_sys - Rust</title><link rel="preload" as="font" type="font/woff2" crossorigin href="../SourceSerif4-Regular.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../FiraSans-Regular.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../FiraSans-Medium.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../SourceCodePro-Regular.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../SourceSerif4-Bold.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../SourceCodePro-Semibold.ttf.woff2"><link rel="stylesheet" type="text/css" href="../normalize.css"><link rel="stylesheet" type="text/css" href="../rustdoc.css" id="mainThemeStyle"><link rel="stylesheet" type="text/css" href="../ayu.css" disabled><link rel="stylesheet" type="text/css" href="../dark.css" disabled><link rel="stylesheet" type="text/css" href="../light.css" id="themeStyle"><script id="default-settings" ></script><script src="../storage.js"></script><script src="../crates.js"></script><script defer src="../main.js"></script>
    <noscript><link rel="stylesheet" href="../noscript.css"></noscript><link rel="alternate icon" type="image/png" href="../favicon-16x16.png"><link rel="alternate icon" type="image/png" href="../favicon-32x32.png"><link rel="icon" type="image/svg+xml" href="../favicon.svg"></head><body class="rustdoc fn"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle">&#9776;</button><a class="sidebar-logo" href="../esp_idf_sys/index.html"><div class="logo-container"><img class="rust-logo" src="../rust-logo.svg" alt="logo"></div>
        </a><h2 class="location"></h2>
    </nav>
    <nav class="sidebar"><a class="sidebar-logo" href="../esp_idf_sys/index.html"><div class="logo-container"><img class="rust-logo" src="../rust-logo.svg" alt="logo"></div>
        </a><div class="sidebar-elems"><h2 class="location"><a href="index.html">In esp_idf_sys</a></h2><div id="sidebar-vars" data-name="mbedtls_x509_crt_verify" data-ty="fn" data-relpath=""></div><script defer src="sidebar-items.js"></script></div></nav><main><div class="width-limiter"><div class="sub-container"><a class="sub-logo-container" href="../esp_idf_sys/index.html"><img class="rust-logo" src="../rust-logo.svg" alt="logo"></a><nav class="sub"><div class="theme-picker hidden"><button id="theme-picker" aria-label="Pick another theme!" aria-haspopup="menu" title="themes"><img width="22" height="22" alt="Pick another theme!" src="../brush.svg"></button><div id="theme-choices" role="menu"></div></div><form class="search-form"><div class="search-container"><span></span><input class="search-input" name="search" autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"><button type="button" id="help-button" title="help">?</button><a id="settings-menu" href="../settings.html" title="settings"><img width="22" height="22" alt="Change settings" src="../wheel.svg"></a></div></form></nav></div><section id="main-content" class="content"><div class="main-heading">
    <h1 class="fqn"><span class="in-band">Function <a href="index.html">esp_idf_sys</a>::<wbr><a class="fn" href="#">mbedtls_x509_crt_verify</a><button id="copy-path" onclick="copy_path(this)" title="Copy item path to clipboard"><img src="../clipboard.svg" width="19" height="18" alt="Copy item path"></button></span></h1><span class="out-of-band"><a class="srclink" href="../src/esp_idf_sys/home/runner/work/esp-idf-sys/esp-idf-sys/target/riscv32imc-esp-espidf/debug/build/esp-idf-sys-7dfe7ad3d08dc6e7/out/bindings.rs.html#55220-55235">source</a> · <a id="toggle-all-docs" href="javascript:void(0)" title="collapse all docs">[<span class="inner">&#x2212;</span>]</a></span></div><div class="docblock item-decl"><pre class="rust fn"><code>pub unsafe extern &quot;C&quot; fn mbedtls_x509_crt_verify(<br>&nbsp;&nbsp;&nbsp;&nbsp;crt: *mut <a class="struct" href="struct.mbedtls_x509_crt.html" title="struct esp_idf_sys::mbedtls_x509_crt">mbedtls_x509_crt</a>, <br>&nbsp;&nbsp;&nbsp;&nbsp;trust_ca: *mut <a class="struct" href="struct.mbedtls_x509_crt.html" title="struct esp_idf_sys::mbedtls_x509_crt">mbedtls_x509_crt</a>, <br>&nbsp;&nbsp;&nbsp;&nbsp;ca_crl: *mut <a class="struct" href="struct.mbedtls_x509_crl.html" title="struct esp_idf_sys::mbedtls_x509_crl">mbedtls_x509_crl</a>, <br>&nbsp;&nbsp;&nbsp;&nbsp;cn: *const <a class="type" href="c_types/type.c_char.html" title="type esp_idf_sys::c_types::c_char">c_char</a>, <br>&nbsp;&nbsp;&nbsp;&nbsp;flags: *mut u32, <br>&nbsp;&nbsp;&nbsp;&nbsp;f_vrfy: Option&lt;unsafe extern &quot;C&quot; fn(arg1: *mut <a class="type" href="c_types/type.c_void.html" title="type esp_idf_sys::c_types::c_void">c_void</a>, arg2: *mut <a class="struct" href="struct.mbedtls_x509_crt.html" title="struct esp_idf_sys::mbedtls_x509_crt">mbedtls_x509_crt</a>, arg3: <a class="type" href="c_types/type.c_int.html" title="type esp_idf_sys::c_types::c_int">c_int</a>, arg4: *mut u32) -&gt; <a class="type" href="c_types/type.c_int.html" title="type esp_idf_sys::c_types::c_int">c_int</a>&gt;, <br>&nbsp;&nbsp;&nbsp;&nbsp;p_vrfy: *mut <a class="type" href="c_types/type.c_void.html" title="type esp_idf_sys::c_types::c_void">c_void</a><br>) -&gt; <a class="type" href="c_types/type.c_int.html" title="type esp_idf_sys::c_types::c_int">c_int</a></code></pre></div><details class="rustdoc-toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>\brief          Verify the certificate signature</p>

<div class="example-wrap"><pre class="rust rust-example-rendered"><code>            <span class="ident">The</span> <span class="ident">verify</span> <span class="ident">callback</span> <span class="ident">is</span> <span class="ident">a</span> <span class="ident">user</span><span class="op">-</span><span class="ident">supplied</span> <span class="ident">callback</span> <span class="ident">that</span>
            <span class="ident">can</span> <span class="ident">clear</span> <span class="op">/</span> <span class="ident">modify</span> <span class="op">/</span> <span class="ident">add</span> <span class="ident">flags</span> <span class="kw">for</span> <span class="ident">a</span> <span class="ident">certificate</span>. <span class="ident">If</span> <span class="ident">set</span>,
            <span class="ident">the</span> <span class="ident">verification</span> <span class="ident">callback</span> <span class="ident">is</span> <span class="ident">called</span> <span class="kw">for</span> <span class="ident">each</span>
            <span class="ident">certificate</span> <span class="kw">in</span> <span class="ident">the</span> <span class="ident">chain</span> (<span class="ident">from</span> <span class="ident">the</span> <span class="ident">trust</span><span class="op">-</span><span class="ident">ca</span> <span class="ident">down</span> <span class="ident">to</span> <span class="ident">the</span>
            <span class="ident">presented</span> <span class="ident">crt</span>). <span class="ident">The</span> <span class="ident">parameters</span> <span class="kw">for</span> <span class="ident">the</span> <span class="ident">callback</span> <span class="ident">are</span>:
            (<span class="ident">void</span> <span class="kw-2">*</span><span class="ident">parameter</span>, <span class="ident">mbedtls_x509_crt</span> <span class="kw-2">*</span><span class="ident">crt</span>, <span class="ident">int</span> <span class="ident">certificate_depth</span>,
            <span class="ident">int</span> <span class="kw-2">*</span><span class="ident">flags</span>). <span class="ident">With</span> <span class="ident">the</span> <span class="ident">flags</span> <span class="ident">representing</span> <span class="ident">current</span> <span class="ident">flags</span> <span class="kw">for</span>
            <span class="ident">that</span> <span class="ident">specific</span> <span class="ident">certificate</span> <span class="ident">and</span> <span class="ident">the</span> <span class="ident">certificate</span> <span class="ident">depth</span> <span class="ident">from</span>
            <span class="ident">the</span> <span class="ident">bottom</span> (<span class="ident">Peer</span> <span class="ident">cert</span> <span class="ident">depth</span> <span class="op">=</span> <span class="number">0</span>).

            <span class="ident">All</span> <span class="ident">flags</span> <span class="ident">left</span> <span class="ident">after</span> <span class="ident">returning</span> <span class="ident">from</span> <span class="ident">the</span> <span class="ident">callback</span>
            <span class="ident">are</span> <span class="ident">also</span> <span class="ident">returned</span> <span class="ident">to</span> <span class="ident">the</span> <span class="ident">application</span>. <span class="ident">The</span> <span class="ident">function</span> <span class="ident">should</span>
            <span class="kw">return</span> <span class="number">0</span> <span class="kw">for</span> <span class="ident">anything</span> (<span class="ident">including</span> <span class="ident">invalid</span> <span class="ident">certificates</span>)
            <span class="ident">other</span> <span class="ident">than</span> <span class="ident">fatal</span> <span class="ident">error</span>, <span class="kw">as</span> <span class="ident">a</span> <span class="ident">non</span><span class="op">-</span><span class="ident">zero</span> <span class="kw">return</span> <span class="ident">code</span>
            <span class="ident">immediately</span> <span class="ident">aborts</span> <span class="ident">the</span> <span class="ident">verification</span> <span class="ident">process</span>. <span class="ident">For</span> <span class="ident">fatal</span>
            <span class="ident">errors</span>, <span class="ident">a</span> <span class="ident">specific</span> <span class="ident">error</span> <span class="ident">code</span> <span class="ident">should</span> <span class="ident">be</span> <span class="ident">used</span> (<span class="ident">different</span>
            <span class="ident">from</span> <span class="ident">MBEDTLS_ERR_X509_CERT_VERIFY_FAILED</span> <span class="ident">which</span> <span class="ident">should</span> <span class="ident">not</span>
            <span class="ident">be</span> <span class="ident">returned</span> <span class="ident">at</span> <span class="ident">this</span> <span class="ident">point</span>), <span class="ident">or</span> <span class="ident">MBEDTLS_ERR_X509_FATAL_ERROR</span>
            <span class="ident">can</span> <span class="ident">be</span> <span class="ident">used</span> <span class="kw">if</span> <span class="ident">no</span> <span class="ident">better</span> <span class="ident">code</span> <span class="ident">is</span> <span class="ident">available</span>.</code></pre></div>
<p>\note           In case verification failed, the results can be displayed
using \c mbedtls_x509_crt_verify_info()</p>
<p>\note           Same as \c mbedtls_x509_crt_verify_with_profile() with the
default security profile.</p>
<p>\note           It is your responsibility to provide up-to-date CRLs for
all trusted CAs. If no CRL is provided for the CA that was
used to sign the certificate, CRL verification is skipped
silently, that is <em>without</em> setting any flag.</p>
<p>\note           The \c trust_ca list can contain two types of certificates:
(1) those of trusted root CAs, so that certificates
chaining up to those CAs will be trusted, and (2)
self-signed end-entity certificates to be trusted (for
specific peers you know) - in that case, the self-signed
certificate doesn’t need to have the CA bit set.</p>
<p>\param crt      a certificate (chain) to be verified
\param trust_ca the list of trusted CAs (see note above)
\param ca_crl   the list of CRLs for trusted CAs (see note above)
\param cn       expected Common Name (can be set to
NULL if the CN must not be verified)
\param flags    result of the verification
\param f_vrfy   verification function
\param p_vrfy   verification parameter</p>
<p>\return         0 (and flags set to 0) if the chain was verified and valid,
MBEDTLS_ERR_X509_CERT_VERIFY_FAILED if the chain was verified
but found to be invalid, in which case *flags will have one
or more MBEDTLS_X509_BADCERT_XXX or MBEDTLS_X509_BADCRL_XXX
flags set, or another error (and flags set to 0xffffffff)
in case of a fatal error encountered during the
verification process.</p>
</div></details></section><section id="search" class="content hidden"></section></div></main><div id="rustdoc-vars" data-root-path="../" data-current-crate="esp_idf_sys" data-themes="ayu,dark,light" data-resource-suffix="" data-rustdoc-version="1.62.0-nightly (055bf4ccd 2022-04-25)" ></div>
</body></html>